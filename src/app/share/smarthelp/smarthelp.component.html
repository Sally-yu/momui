<nz-modal
  class="help-modal"
  [(nzVisible)]="visible" [nzTitle]="title" (nzOnCancel)="cancel()" (nzOnOk)="ok()">
  <div *ngIf="visible">
    <nz-input-group nzSearch [nzAddOnAfter]="helpSearch" style="margin-bottom: 8px;">
      <input type="text" nz-input placeholder="请输入查找关键字" [(ngModel)]="searchValue"/>
    </nz-input-group>
    <ng-template #helpSearch>
      <button nz-button nzType="primary"><i nz-icon nzType="search"></i></button>
    </ng-template>

    <nz-table #Table [nzData]="data"
              nzSize="middle"
              [nzScroll]="{x:'100%',y:'400px'}"
              [nzLoading]="loading"
              [(nzPageSize)]="pageSize"
              [nzPageSizeOptions]="pageOption"
              [nzShowQuickJumper]="showJumper"
    >
      <thead>
      <tr>
        <th
            nzShowCheckbox
            [nzChecked]="selected"
            (nzCheckedChange)="thChecked($event)"
            nzLeft="0px"
            nzWidth="100px"
        ></th>
        <th *ngFor="let c of columns" nzWidth="150px">{{c.name}}</th>
      </tr>
      </thead>
      <tbody *ngIf="!tree">
      <tr *ngFor="let a of Table.data" (click)="rowClick(a)" (dblclick)="rowClick(a);ok()">
        <td nzShowCheckbox [nzChecked]="a==selected"
            (nzCheckedChange)="checkRow($event,a)"
            nzLeft="0px"
        >
        </td>
        <td *ngFor="let c of columns "
            [title]="c.name+':'+(a[c.code]?a[c.code]:'')">{{a[c.code]}}</td>
      </tr>
      </tbody>

      <tbody *ngIf="tree">
      <ng-container *ngFor="let data of Table.data">
        <ng-container *ngFor="let item of mapOfExpandedData[data[path]]">
          <tr *ngIf="(item.parent && item.parent.expand) || !item.parent" (click)="rowClick(item)" (dblclick)="rowClick(item);ok()">
            <td nzShowCheckbox [nzChecked]="item==selected"
                (nzCheckedChange)="checkRow($event,item)"
                nzLeft="0px"
            >
            <td
              [nzIndentSize]="item.level * 20 "
              [nzShowExpand]="!!item.children"
              [(nzExpand)]="item.expand"
              (nzExpandChange)="collapse(mapOfExpandedData[data[path]], item, $event)"
            >
              {{ item[columns[0]["code"]] }}
            </td>
            <td *ngFor="let c of columns.slice(1,columns.length)">{{ item[c["code"]] }}</td>
          </tr>
        </ng-container>
      </ng-container>


      <!--<td *ngFor="let c of columns.slice(1,columns.length-1) "-->
      <!--[title]="c.name+':'+(item[c.code]?item[c.code]:'')">{{item[c.code]}}</td>-->
      </tbody>
    </nz-table>

  </div>
  <div *nzModalFooter>
    <button nz-button (click)="cancel()"> 取消</button>
    <button nz-button [nzLoading]="loading" [disabled]="!selected" [nzType]="'primary'" (click)="ok()"> 确定</button>
  </div>
</nz-modal>
