<nz-modal
  (nzOnCancel)="cancel()"
  (nzOnOk)="ok()" [(nzVisible)]="visible" [nzTitle]="title" class="help-modal">
  <div>
    <nz-input-group [nzAddOnAfter]="helpSearch" nzSearch style="margin-bottom: 8px;">
      <input [(ngModel)]="searchValue" nz-input placeholder="请输入查找关键字" type="text"/>
    </nz-input-group>
    <ng-template #helpSearch>
      <button nz-button nzSearch nzType="primary"><i nz-icon nzType="search"></i></button>
    </ng-template>

    <nz-table #Table [(nzPageSize)]="pageSize"
              [nzData]="data"
              [nzLoading]="loading"
              [nzPageSizeOptions]="pageOption"
              [nzScroll]="{x:'100%',y:'400px'}"
              [nzShowQuickJumper]="showJumper"
              nzSize="middle"
    >
      <thead>
      <tr>
        <th
          (nzCheckedChange)="thChecked($event)"
          [nzChecked]="selected"
          nzLeft="0px"
          nzShowCheckbox
          nzWidth="100px"
        ></th>
        <th nzCustomFilter *ngFor="let c of columns" nzWidth="150px">{{c.name}}
          <i
            *ngIf="columns.indexOf(c)==columns.length-1"
            class="table-setting"
            nz-icon
            nz-dropdown
            #dropdown="nzDropdown"
            nzType="setting"
            [nzDropdownMenu]="menu"
            [class.table-setting]="dropdown.nzVisible"
            nzTrigger="click"
            nzPlacement="bottomRight"
            [nzClickHide]="false"
            nzTableFilter
          ></i>
        </th>
      </tr>
      </thead>
      <tbody *ngIf="!tree">
      <tr (click)="rowClick(a)" (dblclick)="rowClick(a);ok()" *ngFor="let a of Table.data">
        <td (nzCheckedChange)="checkRow($event,a)" [nzChecked]="a==selected"
            nzLeft="0px"
            nzShowCheckbox
        >
        </td>
        <td *ngFor="let c of columns "
            [title]="c.name+':'+(a[c.code]?a[c.code]:'')">{{a[c.code]}}</td>
      </tr>
      </tbody>

      <tbody *ngIf="tree">
      <ng-container *ngFor="let data of Table.data">
        <ng-container *ngFor="let item of mapOfExpandedData[data[path]]">
          <tr (click)="rowClick(item)" (dblclick)="rowClick(item);ok()"
              *ngIf="(item.parent && item.parent.expand) || !item.parent">
            <td (nzCheckedChange)="checkRow($event,item)" [nzChecked]="item==selected"
                nzLeft="0px"
                nzShowCheckbox
            >
            <td
              (nzExpandChange)="collapse(mapOfExpandedData[data[path]], item, $event)"
              [(nzExpand)]="item.expand"
              [nzIndentSize]="item.level * 20 "
              [nzShowExpand]="!!item.children"
            >
              {{ item[columns[0]["code"]] }}
            </td>
            <td *ngFor="let c of columns.slice(1,columns.length)">{{ item[c["code"]] }}</td>
          </tr>
        </ng-container>
      </ng-container>
      </tbody>
    </nz-table>

  </div>
  <div *nzModalFooter>
    <button (click)="cancel()" nz-button> 取消</button>
    <button (click)="ok()" [disabled]="!selected" [nzLoading]="loading" [nzType]="'primary'" nz-button> 确定</button>
  </div>
</nz-modal>


<nz-dropdown-menu #menu="nzDropdownMenu">
  <div class="search-box">
    <input type="text" nz-input placeholder="Search name" [(ngModel)]="searchValue" />
    <button nz-button nzSize="small" nzType="primary"  class="search-button">
      Search
    </button>
    <button nz-button nzSize="small" >Reset</button>
  </div>
</nz-dropdown-menu>
